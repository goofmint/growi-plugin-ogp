const ve="growi-plugin-embed-site",be="1.1.1",_e="GROWI plugin for embed web site",je="MIT",we=["growi","growi-plugin"],Re="module",Ee={dev:"vite",build:"tsc && vite build",preview:"vite preview"},Se={react:"^18.2.0","react-async":"^10.0.1","react-dom":"^18.2.0","react-innertext":"^1.1.5"},Ce={"@types/react":"^18.0.17","@types/react-dom":"^18.3.0","@typescript-eslint/eslint-plugin":"^5.0.0","@typescript-eslint/parser":"^5.0.0","@vitejs/plugin-react":"^4.3.1","@vitejs/plugin-react-swc":"^3.7.0",eslint:"^8.18.0","eslint-config-next":"^12.1.6","eslint-import-resolver-typescript":"^3.2.5","eslint-plugin-import":"^2.26.0","eslint-plugin-jest":"^27.1.0","eslint-plugin-react":"^7.30.1","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-regex":"^1.10.0",jest:"^29.1.2",typescript:"^4.6.4",vite:"^5.4.2"},Pe={schemaVersion:"4",types:["script"]},Ae={name:ve,version:be,description:_e,license:je,keywords:we,type:Re,scripts:Ee,dependencies:Se,devDependencies:Ce,growiPlugin:Pe};function Oe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Z={exports:{}},L={},ee={exports:{}},c={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O=Symbol.for("react.element"),Fe=Symbol.for("react.portal"),xe=Symbol.for("react.fragment"),$e=Symbol.for("react.strict_mode"),ke=Symbol.for("react.profiler"),Ie=Symbol.for("react.provider"),De=Symbol.for("react.context"),Le=Symbol.for("react.forward_ref"),Te=Symbol.for("react.suspense"),Me=Symbol.for("react.memo"),Ne=Symbol.for("react.lazy"),z=Symbol.iterator;function Ge(e){return e===null||typeof e!="object"?null:(e=z&&e[z]||e["@@iterator"],typeof e=="function"?e:null)}var te={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ne=Object.assign,re={};function E(e,t,n){this.props=e,this.context=t,this.refs=re,this.updater=n||te}E.prototype.isReactComponent={};E.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};E.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function oe(){}oe.prototype=E.prototype;function G(e,t,n){this.props=e,this.context=t,this.refs=re,this.updater=n||te}var q=G.prototype=new oe;q.constructor=G;ne(q,E.prototype);q.isPureReactComponent=!0;var J=Array.isArray,ie=Object.prototype.hasOwnProperty,U={current:null},se={key:!0,ref:!0,__self:!0,__source:!0};function ce(e,t,n){var i,r={},l=null,u=null;if(t!=null)for(i in t.ref!==void 0&&(u=t.ref),t.key!==void 0&&(l=""+t.key),t)ie.call(t,i)&&!se.hasOwnProperty(i)&&(r[i]=t[i]);var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){for(var f=Array(d),g=0;g<d;g++)f[g]=arguments[g+2];r.children=f}if(e&&e.defaultProps)for(i in d=e.defaultProps,d)r[i]===void 0&&(r[i]=d[i]);return{$$typeof:O,type:e,key:l,ref:u,props:r,_owner:U.current}}function qe(e,t){return{$$typeof:O,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function V(e){return typeof e=="object"&&e!==null&&e.$$typeof===O}function Ue(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var K=/\/+/g;function M(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ue(""+e.key):t.toString(36)}function k(e,t,n,i,r){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var u=!1;if(e===null)u=!0;else switch(l){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case O:case Fe:u=!0}}if(u)return u=e,r=r(u),e=i===""?"."+M(u,0):i,J(r)?(n="",e!=null&&(n=e.replace(K,"$&/")+"/"),k(r,t,n,"",function(g){return g})):r!=null&&(V(r)&&(r=qe(r,n+(!r.key||u&&u.key===r.key?"":(""+r.key).replace(K,"$&/")+"/")+e)),t.push(r)),1;if(u=0,i=i===""?".":i+":",J(e))for(var d=0;d<e.length;d++){l=e[d];var f=i+M(l,d);u+=k(l,t,n,f,r)}else if(f=Ge(e),typeof f=="function")for(e=f.call(e),d=0;!(l=e.next()).done;)l=l.value,f=i+M(l,d++),u+=k(l,t,n,f,r);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function $(e,t,n){if(e==null)return e;var i=[],r=0;return k(e,i,"","",function(l){return t.call(n,l,r++)}),i}function Ve(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var y={current:null},I={transition:null},Be={ReactCurrentDispatcher:y,ReactCurrentBatchConfig:I,ReactCurrentOwner:U};function le(){throw Error("act(...) is not supported in production builds of React.")}c.Children={map:$,forEach:function(e,t,n){$(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return $(e,function(){t++}),t},toArray:function(e){return $(e,function(t){return t})||[]},only:function(e){if(!V(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};c.Component=E;c.Fragment=xe;c.Profiler=ke;c.PureComponent=G;c.StrictMode=$e;c.Suspense=Te;c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Be;c.act=le;c.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=ne({},e.props),r=e.key,l=e.ref,u=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,u=U.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var d=e.type.defaultProps;for(f in t)ie.call(t,f)&&!se.hasOwnProperty(f)&&(i[f]=t[f]===void 0&&d!==void 0?d[f]:t[f])}var f=arguments.length-2;if(f===1)i.children=n;else if(1<f){d=Array(f);for(var g=0;g<f;g++)d[g]=arguments[g+2];i.children=d}return{$$typeof:O,type:e.type,key:r,ref:l,props:i,_owner:u}};c.createContext=function(e){return e={$$typeof:De,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Ie,_context:e},e.Consumer=e};c.createElement=ce;c.createFactory=function(e){var t=ce.bind(null,e);return t.type=e,t};c.createRef=function(){return{current:null}};c.forwardRef=function(e){return{$$typeof:Le,render:e}};c.isValidElement=V;c.lazy=function(e){return{$$typeof:Ne,_payload:{_status:-1,_result:e},_init:Ve}};c.memo=function(e,t){return{$$typeof:Me,type:e,compare:t===void 0?null:t}};c.startTransition=function(e){var t=I.transition;I.transition={};try{e()}finally{I.transition=t}};c.unstable_act=le;c.useCallback=function(e,t){return y.current.useCallback(e,t)};c.useContext=function(e){return y.current.useContext(e)};c.useDebugValue=function(){};c.useDeferredValue=function(e){return y.current.useDeferredValue(e)};c.useEffect=function(e,t){return y.current.useEffect(e,t)};c.useId=function(){return y.current.useId()};c.useImperativeHandle=function(e,t,n){return y.current.useImperativeHandle(e,t,n)};c.useInsertionEffect=function(e,t){return y.current.useInsertionEffect(e,t)};c.useLayoutEffect=function(e,t){return y.current.useLayoutEffect(e,t)};c.useMemo=function(e,t){return y.current.useMemo(e,t)};c.useReducer=function(e,t,n){return y.current.useReducer(e,t,n)};c.useRef=function(e){return y.current.useRef(e)};c.useState=function(e){return y.current.useState(e)};c.useSyncExternalStore=function(e,t,n){return y.current.useSyncExternalStore(e,t,n)};c.useTransition=function(){return y.current.useTransition()};c.version="18.3.1";ee.exports=c;var ue=ee.exports;const a=Oe(ue);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var We=ue,Ye=Symbol.for("react.element"),He=Symbol.for("react.fragment"),ze=Object.prototype.hasOwnProperty,Je=We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ke={key:!0,ref:!0,__self:!0,__source:!0};function ae(e,t,n){var i,r={},l=null,u=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(u=t.ref);for(i in t)ze.call(t,i)&&!Ke.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)r[i]===void 0&&(r[i]=t[i]);return{$$typeof:Ye,type:e,key:l,ref:u,props:r,_owner:Je.current}}L.Fragment=He;L.jsx=ae;L.jsxs=ae;Z.exports=L;var b=Z.exports;const A=typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global||typeof global=="object"&&global.GLOBAL===global?global:{};A.__REACT_ASYNC__=A.__REACT_ASYNC__||{};const Qe=()=>{};class Xe{constructor(){this.abort=Qe,this.signal={}}}let s;try{s=require("prop-types")}catch{}const R=s&&s.oneOfType([s.node,s.func]),C=s&&s.shape({initialValue:s.any,data:s.any,error:s.instanceOf(Error),value:s.any,startedAt:s.instanceOf(Date),finishedAt:s.instanceOf(Date),status:s.oneOf(["initial","pending","fulfilled","rejected"]),isInitial:s.bool,isPending:s.bool,isLoading:s.bool,isFulfilled:s.bool,isResolved:s.bool,isRejected:s.bool,isSettled:s.bool,counter:s.number,promise:s.instanceOf(Promise),run:s.func,reload:s.func,cancel:s.func,setData:s.func,setError:s.func});var j=s&&{Async:{children:R,promise:s.instanceOf(Promise),promiseFn:s.func,deferFn:s.func,watch:s.any,watchFn:s.func,initialValue:s.any,onResolve:s.func,onReject:s.func,reducer:s.func,dispatcher:s.func,debugLabel:s.string,suspense:s.bool},Initial:{children:R,state:C.isRequired,persist:s.bool},Pending:{children:R,state:C.isRequired,initial:s.bool},Fulfilled:{children:R,state:C.isRequired,persist:s.bool},Rejected:{children:R,state:C.isRequired,persist:s.bool},Settled:{children:R,state:C.isRequired,persist:s.bool}};const F=(e,...t)=>typeof e=="function"?e(...t):e,fe=({children:e,persist:t,state:n={}})=>a.createElement(a.Fragment,null,n.isInitial||t&&!n.data?F(e,n):null),pe=({children:e,initial:t,state:n={}})=>a.createElement(a.Fragment,null,n.isPending&&(!t||!n.value)?F(e,n):null),de=({children:e,persist:t,state:n={}})=>a.createElement(a.Fragment,null,n.isFulfilled||t&&n.data?F(e,n.data,n):null),he=({children:e,persist:t,state:n={}})=>a.createElement(a.Fragment,null,n.isRejected||t&&n.error?F(e,n.error,n):null),me=({children:e,persist:t,state:n={}})=>a.createElement(a.Fragment,null,n.isSettled||t&&n.value?F(e,n):null);j&&(fe.propTypes=j.Initial,pe.propTypes=j.Pending,de.propTypes=j.Fulfilled,he.propTypes=j.Rejected,me.propTypes=j.Settled);var h;(function(e){e.initial="initial",e.pending="pending",e.fulfilled="fulfilled",e.rejected="rejected"})(h||(h={}));const Ze=(e,t)=>e instanceof Error?h.rejected:e!==void 0?h.fulfilled:t?h.pending:h.initial,et=e=>e instanceof Error?h.rejected:e!==void 0?h.fulfilled:h.initial,P=e=>({status:e,isInitial:e===h.initial,isPending:e===h.pending,isLoading:e===h.pending,isFulfilled:e===h.fulfilled,isResolved:e===h.fulfilled,isRejected:e===h.rejected,isSettled:e===h.fulfilled||e===h.rejected}),D=function(){};Object.setPrototypeOf?Object.setPrototypeOf(D,Promise):D.__proto__=Promise;D.prototype=Object.assign(Object.create(Promise.prototype),{finally(){return this},catch(){return this},then(){return this}});const N=new D;var _;(function(e){e.start="start",e.cancel="cancel",e.fulfill="fulfill",e.reject="reject"})(_||(_={}));const tt=({initialValue:e,promise:t,promiseFn:n})=>({initialValue:e,data:e instanceof Error?void 0:e,error:e instanceof Error?e:void 0,value:e,startedAt:t||n?new Date:void 0,finishedAt:e?new Date:void 0,...P(Ze(e,t||n)),counter:0,promise:N}),Q=(e,t)=>{switch(t.type){case _.start:return{...e,startedAt:new Date,finishedAt:void 0,...P(h.pending),counter:t.meta.counter,promise:t.meta.promise};case _.cancel:return{...e,startedAt:void 0,finishedAt:void 0,...P(et(e.error||e.data)),counter:t.meta.counter,promise:t.meta.promise};case _.fulfill:return{...e,data:t.payload,value:t.payload,error:void 0,finishedAt:new Date,...P(h.fulfilled),promise:t.meta.promise};case _.reject:return{...e,error:t.payload,value:t.payload,finishedAt:new Date,...P(h.rejected),promise:t.meta.promise};default:return e}},nt=e=>(t,...n)=>{e(t,...n),t.type===_.start&&typeof t.payload=="function"&&t.payload()};class at extends a.Component{}function rt(e={},t="Async"){const{Consumer:n,Provider:i}=a.createContext(void 0);function r({children:v}){return a.createElement(n,null,o=>{if(!o)throw new Error("this component should only be used within an associated <Async> component!");return v(o)})}class l extends a.Component{constructor(o){super(o),this.mounted=!1,this.counter=0,this.args=[],this.promise=N,this.abortController=new Xe,this.start=this.start.bind(this),this.load=this.load.bind(this),this.run=this.run.bind(this),this.cancel=this.cancel.bind(this),this.onResolve=this.onResolve.bind(this),this.onReject=this.onReject.bind(this),this.setData=this.setData.bind(this),this.setError=this.setError.bind(this);const p=o.promise,m=o.promiseFn||e.promiseFn,w=o.initialValue||e.initialValue;this.state={...tt({initialValue:w,promise:p,promiseFn:m}),cancel:this.cancel,run:this.run,reload:()=>{this.load(),this.run(...this.args)},setData:this.setData,setError:this.setError},this.debugLabel=o.debugLabel||e.debugLabel;const{devToolsDispatcher:x}=A.__REACT_ASYNC__,W=o.reducer||e.reducer,Y=o.dispatcher||e.dispatcher||x,ye=W?(S,T)=>W(S,T,Q):Q,H=nt((S,T)=>{this.setState(ge=>ye(ge,S),T)});this.dispatch=Y?S=>Y(S,H,o):H}componentDidMount(){this.mounted=!0,(this.props.promise||!this.state.initialValue)&&this.load()}componentDidUpdate(o){const{watch:p,watchFn:m=e.watchFn,promise:w,promiseFn:x}=this.props;if(p!==o.watch)return this.counter&&this.cancel(),this.load();if(m&&m({...e,...this.props},{...e,...o}))return this.counter&&this.cancel(),this.load();if(w!==o.promise&&(this.counter&&this.cancel(),w))return this.load();if(x!==o.promiseFn&&(this.counter&&this.cancel(),x))return this.load()}componentWillUnmount(){this.cancel(),this.mounted=!1}getMeta(o){return{counter:this.counter,promise:this.promise,debugLabel:this.debugLabel,...o}}start(o){return"AbortController"in A&&(this.abortController.abort(),this.abortController=new A.AbortController),this.counter++,this.promise=new Promise((p,m)=>{if(!this.mounted)return;const w=()=>o().then(p,m);this.dispatch({type:_.start,payload:w,meta:this.getMeta()})})}load(){const o=this.props.promise,p=this.props.promiseFn||e.promiseFn;if(o)this.start(()=>o).then(this.onResolve(this.counter)).catch(this.onReject(this.counter));else if(p){const m={...e,...this.props};this.start(()=>p(m,this.abortController)).then(this.onResolve(this.counter)).catch(this.onReject(this.counter))}}run(...o){const p=this.props.deferFn||e.deferFn;if(p){this.args=o;const m={...e,...this.props};return this.start(()=>p(o,m,this.abortController)).then(this.onResolve(this.counter),this.onReject(this.counter))}}cancel(){const o=this.props.onCancel||e.onCancel;o&&o(),this.counter++,this.abortController.abort(),this.mounted&&this.dispatch({type:_.cancel,meta:this.getMeta()})}onResolve(o){return p=>{if(this.counter===o){const m=this.props.onResolve||e.onResolve;this.setData(p,()=>m&&m(p))}return p}}onReject(o){return p=>{if(this.counter===o){const m=this.props.onReject||e.onReject;this.setError(p,()=>m&&m(p))}return p}}setData(o,p){return this.mounted&&this.dispatch({type:_.fulfill,payload:o,meta:this.getMeta()},p),o}setError(o,p){return this.mounted&&this.dispatch({type:_.reject,payload:o,error:!0,meta:this.getMeta()},p),o}render(){const{children:o,suspense:p}=this.props;if(p&&this.state.isPending&&this.promise!==N)throw this.promise;if(typeof o=="function"){const m=o;return a.createElement(i,{value:this.state},m(this.state))}return o!=null?a.createElement(i,{value:this.state},o):null}}j&&(l.propTypes=j.Async);const u=v=>a.createElement(r,null,o=>a.createElement(fe,Object.assign({},v,{state:o}))),d=v=>a.createElement(r,null,o=>a.createElement(pe,Object.assign({},v,{state:o}))),f=v=>a.createElement(r,null,o=>a.createElement(de,Object.assign({},v,{state:o}))),g=v=>a.createElement(r,null,o=>a.createElement(he,Object.assign({},v,{state:o}))),B=v=>a.createElement(r,null,o=>a.createElement(me,Object.assign({},v,{state:o})));return u.displayName=`${t}.Initial`,d.displayName=`${t}.Pending`,f.displayName=`${t}.Fulfilled`,g.displayName=`${t}.Rejected`,B.displayName=`${t}.Settled`,Object.assign(l,{displayName:t,Initial:u,Pending:d,Loading:d,Fulfilled:f,Resolved:f,Rejected:g,Settled:B})}var ot=rt();const it="https://ogp-scanner.kunon.jp/v1/ogp_info",st="https://placehold.jp/24/5C9A29/ffffff/480x360.png",ct=async({href:e})=>await(await fetch(`${it}?url=${encodeURIComponent(e)}`)).json(),X=e=>({children:t,href:n,...i})=>{try{return console.log({children:t,href:n,props:i}),t===null||t!=="OGP"?b.jsx(e,{href:n,...i,children:t}):b.jsx(ot,{promiseFn:ct,href:n,children:({data:r,error:l,isPending:u})=>u?"Loading...":l?`Something went wrong: ${l.message}`:r?b.jsxs("div",{className:"row ogp",children:[b.jsx("div",{className:"col-3",children:b.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",children:b.jsx("img",{src:r.ogp["og:image"]||st,alt:r.html.title})})}),b.jsxs("div",{className:"col-9",children:[b.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",children:b.jsx("strong",{children:r.html.title})}),b.jsx("p",{children:r.html.description||r.ogp["og:description"].join("")}),r.ogp["og:site_name"]&&b.jsx("div",{style:{color:"#777"},children:r.ogp["og:site_name"]})]})]}):null})}catch{return b.jsx(e,{href:n,...i,children:t})}},lt=()=>{if(growiFacade==null||growiFacade.markdownRenderer==null)return;const{optionsGenerators:e}=growiFacade.markdownRenderer,t=e.customGenerateViewOptions;e.customGenerateViewOptions=(...i)=>{const r=t?t(...i):e.generateViewOptions(...i),l=r.components.a;return r.components.a=X(l),r};const n=e.customGeneratePreviewOptions;e.customGeneratePreviewOptions=(...i)=>{const r=n?n(...i):e.generatePreviewOptions(...i),{a:l}=r.components;return r.components.a=X(l),r}},ut=()=>{};window.pluginActivators==null&&(window.pluginActivators={});window.pluginActivators[Ae.name]={activate:lt,deactivate:ut};
